USE riverbed;
DROP TABLE host_metrics;
CREATE TABLE host_metrics (
  id MEDIUMINT NOT NULL AUTO_INCREMENT,
  queryTime DATETIME DEFAULT CURRENT_TIMESTAMP,
  address VARCHAR(15) NOT NULL,
  host VARCHAR(254) NOT NULL,
  avgBytesPerSecond DOUBLE NOT NULL DEFAULT 0,
  avgPacketsPerSecond DOUBLE NOT NULL DEFAULT 0,
  avgConnPerSecond DOUBLE NOT NULL DEFAULT 0,
  PRIMARY KEY ( id, queryTime, address )
) PARTITION BY RANGE COLUMNS ( queryTime ) (
  PARTITION p201605 VALUES LESS THAN ( '2016-06-01' ),
  PARTITION p201606 VALUES LESS THAN ( '2016-07-01' ),
  PARTITION p201607 VALUES LESS THAN ( '2016-08-01' ),
  PARTITION p201608 VALUES LESS THAN ( '2016-09-01' ),
  PARTITION p201609 VALUES LESS THAN ( '2016-10-01' ),
  PARTITION p201610 VALUES LESS THAN ( '2016-11-01' ),
  PARTITION p201611 VALUES LESS THAN ( '2016-12-01' ),
  PARTITION p201612 VALUES LESS THAN ( '2017-01-01' ),
  PARTITION BUCKET  VALUES LESS THAN (MAXVALUE)
);
ALTER TABLE host_metrics ADD INDEX (address);
